# 项目快速归档（summary_v0.1.5）

版本：v0.1.5

## 变更要点

### 前端功能增强
- **视频输入支持**：在边缘检测页面添加了视频模式，支持上传视频文件并实时显示边缘检测效果
  - 左侧显示原始视频播放器
  - 右侧实时显示边缘检测结果（使用Canvas渲染）
  - 支持播放/暂停控制，自动处理视频帧
- **保存功能**：添加了保存按钮，可以将边缘检测结果保存到本地
  - 图片模式：保存边缘检测结果图片（PNG格式）
  - 视频模式：保存当前帧的边缘检测结果
  - 自动命名：文件名包含算法名称和时间戳
- **BSDS500快速测试**：添加了"快速测试:BSDS500"按钮
  - 自动从BSDS500数据集读取图片（默认使用验证集）
  - 使用真实的人工标注ground truth进行评估（而非Canny伪参考）
  - 自动计算ODS/OIS指标和PR曲线
- **开发日志功能**：新增开发日志页面，可视化Git提交记录
  - 显示提交哈希、作者、日期、提交信息
  - 显示修改的文件列表
  - 支持搜索功能
  - 相对时间显示（刚刚、X分钟前等）
- **GitHub链接**：在左侧栏添加GitHub图标按钮，点击跳转到仓库页面

### 后端API改进
- **视频处理API**：复用现有的`/api/edge-detect`接口处理视频帧
- **BSDS500快速测试API**：新增`/api/bsds500-quick-test`端点
  - 自动从BSDS500数据集读取图片
  - 加载ground truth标注（.mat文件）
  - 使用真实标注进行评估
- **Git日志API**：新增`/api/git-log`端点
  - 自动查找Git仓库根目录
  - 解析Git提交记录
  - 处理Windows编码问题（UTF-8）
- **输出文件夹命名优化**：批量处理输出文件夹名称改为"算法名称+参数"格式
  - Canny算法：`Canny_blur7_canny100_220`
  - Sobel算法：`Sobel_blur7_sobelK3`
  - BSDS500测试：`BSDS500_val_Canny_blur7_canny100_220`
  - 如果文件夹已存在，自动添加序号避免覆盖

### 算法名称规范化
- 将"彩色Canny"和"彩色Sobel"统一改为"color-canny"和"color-sobel"
- 无论中英文模式都使用统一的英文名称
- 更新了所有相关的前端选项和后端判断逻辑

### 批量处理算法优化
- **Canny算法**：在批量处理中实现了真正的Canny算法
  - 包含非极大值抑制（NMS）
  - 包含类双阈值处理
  - 生成强度图用于PR曲线生成
- **彩色Canny算法**：对每个颜色通道分别应用NMS
  - 合并三个通道的结果
  - 保持真正的Canny算法特性

### 界面优化
- **左侧栏改进**：
  - 语言切换下方添加分割线
  - 添加开发日志按钮
  - 添加GitHub链接按钮
- **国际化完善**：添加了视频、保存、开发日志等相关的中英文翻译

## 文件变更

### 新增文件
- `vue-frontend/src/views/Changelog.vue` - 开发日志页面
- `docs/AIchat/summary_v0.1.5.md` - 本版本总结

### 修改文件
- `vue-frontend/src/views/EdgeDetection.vue` - 添加视频模式、保存功能、BSDS500快速测试
- `vue-frontend/src/components/Sidebar.vue` - 添加开发日志和GitHub按钮
- `vue-frontend/src/router.js` - 添加开发日志路由
- `vue-frontend/src/i18n.js` - 添加相关国际化文本
- `edge_detection_api.py` - 添加视频处理、BSDS500测试、Git日志API，优化批量处理算法

## 技术细节

### 视频处理
- 使用HTML5 `<video>`元素播放视频
- 使用`requestAnimationFrame`优化帧处理性能
- 视频帧使用JPEG压缩（质量0.8）减少数据传输量
- 处理频率自适应，避免过度请求

### Git日志解析
- 自动向上查找Git仓库根目录（最多10层）
- 使用UTF-8编码处理，解决Windows GBK编码问题
- 解析Git log输出，提取提交信息、作者、日期、文件列表

### BSDS500 Ground Truth加载
- 从`.mat`文件读取多个标注者的边界标注
- 合并所有标注为并集
- 缩放到处理尺寸（640x480）
- 转换为0/255的uint8格式

## 使用说明

### 视频边缘检测
1. 切换到"视频模式"
2. 选择视频文件
3. 点击播放，右侧会实时显示边缘检测结果
4. 可以点击"保存边缘检测结果"保存当前帧

### BSDS500快速测试
1. 在边缘检测页面展开"批量处理"区域
2. 点击"快速测试:BSDS500"按钮
3. 系统自动处理BSDS500验证集图片
4. 使用真实ground truth评估，显示ODS/OIS指标和PR曲线

### 开发日志
1. 点击左侧栏"开发日志"按钮
2. 查看Git提交记录
3. 使用搜索框过滤提交记录
4. 点击"刷新"重新加载最新记录

## 注意事项

- **视频处理性能**：视频帧处理需要一定时间，建议使用较小的视频文件或降低处理频率
- **Git日志**：需要Git仓库才能使用开发日志功能
- **BSDS500数据集**：确保`BSR_bsds500/BSDS500/data/`目录存在且包含ground truth文件
- **编码问题**：已处理Windows系统的编码问题，使用UTF-8编码

## 下一步建议

- 可以考虑添加视频导出功能（将处理后的视频保存为文件）
- 可以添加更多数据集支持（如其他边缘检测数据集）
- 可以优化视频处理的性能（使用Web Workers或后端处理）
- 可以添加提交记录的详细视图（显示文件差异等）

---
生成时间：2025-12-07
版本：v0.1.5




